{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="{% static '/main/css/main.css' %}">
    <link rel="stylesheet" href="{% static '/bootstrap-5.3.3-dist/css/bootstrap.css' %}">
    {#    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">#}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

</head>
<body>
<header>
    <nav class="navbar navbar-expand-lg navbar-dark f-bc-green py-2">
        <div class="nav_t container">
            <ul class="d-flex justify-content-between align-items-center ul_li ps-0 mb-0">
                <li class="nav-item w-25">
                    <a href="" class="">
                        <img src="{% static '/main/img/olx-logo.png' %}" alt="" class="w-25" aria-current="page">
                    </a>
                </li>
                <li class="nav-item ps-5 ms-5">
                    <a class="navbar-brand fw-medium fs-6 me-0 active" href="" aria-current="page">
                        <i class="fa-regular fa-comment fs-5 me-3 mt-1"></i> Сообщения</a>
                </li>
                <li class="nav-item ">
                    <a class="navbar-brand fw-lighter fs-6 me-2 a_c" href="" aria-current="page">O'z</a>
                    <span class="fw-lighter a_c active"> | </span>
                    <a class="navbar-brand fw-lighter fs-6 ms-2 a_c active" href="" aria-current="page">Рус</a>
                </li>
                <li class="nav-item ">
                    <a class="navbar-brand fw-medium fs-5 me-0" href="" aria-current="page">
                        <i class="fa-regular fa-heart"></i>
                    </a>
                </li>
                <li class="nav-item ">
                    <a class="navbar-brand fw-medium fs-6 me-0" href="" aria-current="page">
                        <i class="fa-regular fa-user fs-5 me-3"></i> Ваш профиль</a>
                </li>
                <li class="h_button ">
                    <a href="" class="text_dn1">
                        <button class="btn btn-light py-2 px-lg-4 fw-bolder rounded-3 border-3">Подать объявление
                        </button>
                    </a>
                </li>
                <li class="nav-item d-lg-none">
                    <button class="navbar-toggler border-0 p-0" type="menu" data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                        <a class="border-bottom-0" id="menu" aria-current="page" href="#">
                            <i class="bi bi-list font_style_g font_fv" style="font-size: 38px; font-weight: 700;"></i>
                        </a>
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    {#    <div class="search_item py-5 f-bc-grey">#}
    {#        <form class="container" role="search">#}
    {#            {% csrf_token %}#}
    {#            <div class="row row-cols-3">#}
    {#                <div class="col-7 px-0 i-search">#}
    {#                    <label for="search">Filter</label>#}
    {#                    <div class="d-flex align-items-center">#}
    {#                        <input class="form-control py-4 me-1 position-relative f-c-green border-0 rounded-start-4"#}
    {#                               id="search" style="padding-left: 55px;" type="search" placeholder="Что ищете?"#}
    {#                               aria-label="Search">#}
    {#                        <i class="bi bi-search position-absolute ps-3 fs-4 f-c-green"></i>#}
    {#                    </div>#}
    {##}
    {#                    <div class="bg-white z-0 position-absolute py-2 ps-4 mt-2 fs-4 rounded-2"#}
    {#                         id="search_label"#}
    {#                         style="padding-right: 560px;!important;display: none">#}
    {#                        <p class="text-gray mb-0" style="font-size: 12px">ВЫ НЕДАВНО ИСКАЛИ</p>#}
    {#                        <div class="ps-3" id="serach_label_div">#}
    {#                            <h3 id="search_label_o" class="fs-5 f-c-green" style="font-size: 10px">something</h3>#}
    {#                            <p id="search_label_p" class="fw-light f-c-green" style="font-size: 9px">Electronics /#}
    {#                                Phones / MobilePhone</p>#}
    {#                        </div>#}
    {#                    </div>#}
    {#                </div>#}
    {#                <div class="d-flex align-items-center col-3 px-0">#}
    {#                    <input class="form-control py-4 position-relative f-c-green border-0 rounded-0" id="search-id"#}
    {#                           style="padding-left: 50px;" type="text" placeholder="Вся страна">#}
    {#                    <i class="bi bi-geo-alt i-location position-absolute ps-3 fs-4 f-c-green"></i>#}
    {#                </div>#}
    {#                <button class="btn text-white col-2 position-relative border-left-0 rounded-end-4" ,#}
    {#                        style="background-color: #002F34; font-weight: 700;" id="search-b">#}
    {#                    Поиск <i class="bi bi-search text-white" style="font-size: 21px;"></i>#}
    {#                </button>#}
    {#            </div>#}
    {#        </form>#}
    {#    </div>#}

    <div class="search_item py-5 f-bc-grey">
        <form class="container" role="search">
            {% csrf_token %}
            <div class="row row-cols-3">
                <div class="col-7 px-0 i-search">
                    <div class="d-flex align-items-center">
                        <input class="form-control py-4 me-1 position-relative f-c-green border-0 rounded-start-4"
                               id="search" type="search" placeholder="Что ищете?" aria-label="Search">
                        <i class="bi bi-search position-absolute ps-3 fs-4 f-c-green"></i>
                    </div>
                    <div class="bg-white z-0 position-absolute py-2 ps-4 mt-2 fs-4 rounded-2"
                         id="result"
                         style="padding-right: 560px;!important;display: none">
                        <p class="text-gray mb-0" style="font-size: 12px">ВЫ НЕДАВНО ИСКАЛИ</p>
                        <div class="ps-3" id="serach_label_div">
                            <h3 id="search_label_o" class="fs-5 f-c-green" style="font-size: 10px">something</h3>
                            <p id="search_label_p" class="fw-light f-c-green" style="font-size: 9px">Electronics /
                                Phones / MobilePhone</p>
                        </div>
                    </div>
{#                    <ul id="result" class="list-group"></ul>#}
                </div>
                <div class="d-flex align-items-center col-3 px-0">
                    <input class="form-control py-4 position-relative f-c-green border-0 rounded-0" id="search-id"
                           type="text" placeholder="Вся страна">
                    <i class="bi bi-geo-alt i-location position-absolute ps-3 fs-4 f-c-green"></i>
                </div>
                <button class="btn text-white col-2 position-relative border-left-0 rounded-end-4"
                        style="background-color: #002F34; font-weight: 700;" id="search-b">
                    Поиск <i class="bi bi-search text-white" style="font-size: 21px;"></i>
                </button>
            </div>
        </form>
    </div>


</header>

</body>

<div class="" id="search_id"></div>
{#<script src="{% static 'main/js/main.js' %}"></script>#}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
        integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
<script>

    const input = document.getElementById('search');
    const myDiv = document.getElementById('search_label');
    input.addEventListener('focus', () => {
        myDiv.style.display = 'block';
    });
    input.addEventListener('blur', (event) => {
        setTimeout(() => {
            myDiv.style.display = 'none';
        }, 100);
    });

    $(document).ready(function () {
        $.ajaxSetup({cache: false});

        $('#search').keyup(function () {
            $('#result').html('');  // Clear previous results
            var searchField = $('#search').val();  // Get the search input value

            if (searchField.length > 0) {  // Only perform the search if there is text
                $.ajax({
                    url: "http://127.0.0.1:8000/api/colors/?search=" + searchField,  // REST API endpoint
                    type: 'GET',
                    success: function (data) {
                        $.each(data.results, function (key, value) {
                            $('#result').append(`
                            <li class="list-group-item link-class">
                                <div class="ps-3" id="serach_label_div">
                                    <h3 id="search_label_o" class="fs-5 f-c-green" style="font-size: 10px">${value.name}</h3>
                                    <p id="search_label_p" class="fw-light f-c-green" style="font-size: 9px">${value.code}</p>
                                </div>
                            </li>
                        `);
                        });
                    },
                    error: function () {
                        $('#result').html('<li>No results found</li>');
                    }
                });
            } else {
                $('#result').html('');  // Clear the results if the input is empty
            }
        });

        // Handle the click event on search result items
        $('#result').on('click', 'li', function () {
            var click_text = $(this).find('h3').text();  // Get the clicked item’s text
            $('#search').val($.trim(click_text));  // Fill the search input with the selected text
            $("#result").html('');  // Clear the search results
        });
    });


</script>

</html>
